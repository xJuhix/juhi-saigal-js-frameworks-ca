{"version":3,"file":"yup.js","sources":["../../src/yup.ts"],"sourcesContent":["import { Resolver, transformToNestObject, FieldValues } from 'react-hook-form';\nimport Yup from 'yup';\n\nconst parseErrorSchema = (\n  error: Yup.ValidationError,\n  validateAllFieldCriteria: boolean,\n) =>\n  Array.isArray(error.inner) && error.inner.length\n    ? error.inner.reduce(\n        (previous: Record<string, any>, { path, message, type }) => {\n          const previousTypes = (previous[path] && previous[path].types) || {};\n          const key = path || type;\n\n          return {\n            ...previous,\n            ...(key\n              ? {\n                  [key]: {\n                    ...(previous[key] || {\n                      message,\n                      type,\n                    }),\n                    ...(validateAllFieldCriteria\n                      ? {\n                          types: {\n                            ...previousTypes,\n                            [type]: previousTypes[type]\n                              ? [...[].concat(previousTypes[type]), message]\n                              : message,\n                          },\n                        }\n                      : {}),\n                  },\n                }\n              : {}),\n          };\n        },\n        {},\n      )\n    : {\n        [error.path]: { message: error.message, type: error.type },\n      };\n\nexport const yupResolver = <TFieldValues extends FieldValues>(\n  schema: Yup.ObjectSchema | Yup.Lazy,\n  options: Omit<Yup.ValidateOptions, 'context'> = {\n    abortEarly: false,\n  },\n): Resolver<TFieldValues> => async (\n  values,\n  context,\n  validateAllFieldCriteria = false,\n) => {\n  try {\n    if (\n      (options as Yup.ValidateOptions).context &&\n      process.env.NODE_ENV === 'development'\n    ) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        \"You should not used the yup options context. Please, use the 'useForm' context object instead\",\n      );\n    }\n    return {\n      values: (await schema.validate(values, {\n        ...options,\n        context,\n      })) as any,\n      errors: {},\n    };\n  } catch (e) {\n    const parsedErrors = parseErrorSchema(e, validateAllFieldCriteria);\n    return {\n      values: {},\n      errors: transformToNestObject(parsedErrors),\n    };\n  }\n};\n"],"names":["schema","options","abortEarly","values","context","validateAllFieldCriteria","process","env","NODE_ENV","validate","_a","_b","parsedErrors","error","Array","isArray","inner","length","reduce","previous","path","message","type","previousTypes","types","key","concat","parseErrorSchema","e_1","errors","transformToNestObject"],"mappings":"2KA2C2B,SACzBA,EACAC,GAG2B,oBAH3BA,GACEC,YAAY,IAEa,SAC3BC,EACAC,EACAC,uBAAAA,2HAaa,6BATRJ,EAAgCG,SACjCE,QAAQC,IAAIC,iBAQGR,EAAOS,SAASN,2BAC1BF,IACHG,qBAHJ,UACEM,SAASC,SAITD,SAAQ,cAIV,kBADME,EApEe,SACvBC,EACAR,SAEA,OAAAS,MAAMC,QAAQF,EAAMG,QAAUH,EAAMG,MAAMC,OACtCJ,EAAMG,MAAME,QACV,SAACC,EAA+BT,WAAEU,SAAMC,YAASC,SACzCC,EAAiBJ,EAASC,IAASD,EAASC,GAAMI,OAAU,GAC5DC,EAAML,GAAQE,EAEpB,gCACKH,GACCM,UAEGA,4BACKN,EAASM,IAAQ,CACnBJ,UACAC,SAEEjB,EACA,CACEmB,+BACKD,WACFD,GAAOC,EAAcD,cACd,GAAGI,OAAOH,EAAcD,KAAQD,IACpCA,OAGR,OAGR,MAGR,YAGCR,EAAMO,MAAO,CAAEC,QAASR,EAAMQ,QAASC,KAAMT,EAAMS,SA+BnCK,CAAiBC,EAAGvB,MAClC,CACLF,OAAQ,GACR0B,OAAQC,wBAAsBlB"}